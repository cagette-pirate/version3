<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>D√©sinscription</title>
</head>
<body>
  <h1 id="message">Traitement de votre d√©sinscription...</h1>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get('token');

    fetch(`https://pirate-2ea6.onrender.com/api/unsubscribe?token=${token}`)
      .then(response => {
        if (!response.ok) throw new Error("Erreur HTTP");
        return response.json();
      })
      .then(data => {
        const msg = document.getElementById("message");
        msg.innerText = data.success
          ? "üò¢ Vous avez √©t√© d√©sinscrit¬∑e de la newsletter Cagette Pirate. √Ä bient√¥t !"
          : "‚ö†Ô∏è Le lien de d√©sinscription est invalide ou a d√©j√† √©t√© utilis√©.";
      })
      .catch(error => {
        console.error("Erreur de d√©sinscription :", error);
        document.getElementById("message").innerText =
          "‚ùå Une erreur est survenue pendant la d√©sinscription.";
      });
  </script>
</body>
</html>
